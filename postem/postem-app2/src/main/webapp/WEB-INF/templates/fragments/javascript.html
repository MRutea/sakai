<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<body>
<script th:fragment="createGradeBookJs" th:inline="javascript">
  /*<![CDATA[*/
  // Load dropzone library
  includeWebjarLibrary('dropzone');
  
$( document ).ready(function() {
	
	const uploadMax = document.getElementById('uploadMax').value;
  // myDropzone is the configuration for the element that has an id attribute
  // with the value my-dropzone (or myDropzone)
   Dropzone.options.dropzoneForm = {
	  autoProcessQueue: false,
	  acceptedFiles: ".csv",
	  maxFiles: 1,
	  maxFilesize: uploadMax, // MB
      addRemoveLinks: true,
      init: function () {
    	var dz = this;
    	var status;
    	var errorMessage;
        var submitButton = document.querySelector("#gradebook-continue-button");
        
		this.on('maxfilesexceeded', function(file) { 
			this.removeFile(file);
		});
		
		this.on("removedfile", function (file) {
    		submitButton.disabled = false;
    		document.getElementById('uploadingFailed').style.display = 'none';
    		document.getElementById('uploadingFailed').textContent = ''; 
        });
		
        // Client side copyright check
        submitButton.addEventListener("click", function(e) {
        	console.log('submit');
        	
            // Make sure that the form isn't actually being sent.
            e.preventDefault();
            e.stopPropagation();
            
            if (dz.getQueuedFiles().length > 0) { 
            	dz.processQueue();	
            } else {
            	document.getElementById('addContentForm').submit();
            }
        });
		
        this.on('success', function(file, responseText, e) {
            status = file.status;
        	console.log('success');
        });
        
        this.on("error", function(file, message, xhr) {
        	errorMessage = xhr.response;
            status = file.status;
        });
        
        this.on('queuecomplete', function() {
        	console.log('queuecomplete');
        	if (status === Dropzone.SUCCESS) {
            	console.log('queuecomplete1');
            	document.getElementById('addContentForm').submit();
        	} else {
            	console.log('queuecomplete2');
        		submitButton.disabled = true;
        		document.getElementById('uploadingFailed').style.display = 'block';
        		document.getElementById('uploadingFailed').textContent = errorMessage; 
        	}
        });
		
      }
    };
});

  /*]]>*/
</script>

<script th:fragment="studentViewJs" th:inline="javascript">
  /*<![CDATA[*/
  var studentViewFunctions = {
		  
    showStudent: function () {
      const selectedParticipant = document.getElementById('selectedParticipant').value;
      document.getElementById('student_view_form').action = document.getElementById('student_view_form').action+'/'+selectedParticipant;
      document.getElementById('student_view_form').submit();
    }
}
  /*]]>*/
</script>

</script>
<script th:fragment="indexJs" th:inline="javascript">
  /*<![CDATA[*/
  var indexFunctions = {
    checkSubmitButton : function () {
      var anyCheckboxEnabled = false;
      $(':checkbox').each(function() {
        if(this.checked) {
          $('#delete-groups-submit-button').attr('disabled', false);
          anyCheckboxEnabled = true;
        }
      });

      if(!anyCheckboxEnabled) {
        $('#delete-groups-submit-button').attr('disabled', true);
      }
    }

  }
  /*]]>*/
  </script>

</body>
</html>
